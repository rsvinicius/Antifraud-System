Stage 5/6: Rule-based system 